USE programmers_join;

CREATE TABLE ANIMAL_INS2 (
	ANIMAL_ID VARCHAR(20) PRIMARY KEY NOT NULL,
    ANIMAL_TYPE VARCHAR(20) NOT NULL,
    DATETIME DATETIME NOT NULL,
    INTAKE_CONDITION VARCHAR(20) NOT NULL,
    NAME VARCHAR(50),
    SEX_UPON_INTAKE VARCHAR(20) NOT NULL
);

CREATE TABLE ANIMAL_OUTS2 (
	ANIMAL_ID VARCHAR(20) PRIMARY KEY NOT NULL,
    ANIMAL_TYPE VARCHAR(20) NOT NULL,
    DATETIME DATETIME NOT NULL,
	NAME VARCHAR(50),
    SEX_UPON_OUTCOME VARCHAR(20) NOT NULL,
    FOREIGN KEY (ANIMAL_ID) REFERENCES ANIMAL_INS2(ANIMAL_ID)
);

SHOW TABLES;

INSERT INTO ANIMAL_INS2 (ANIMAL_ID, ANIMAL_TYPE, DATETIME, INTAKE_CONDITION, NAME, SEX_UPON_INTAKE) VALUES
('A354597', 'Cat', '2014-05-02 12:16:00', 'Normal', 'Ariel', 'Spayed Female'),
('A373687', 'Dog', '2014-03-20 12:31:00', 'Normal', 'Rosie', 'Spayed Female'),
('A412697', 'Dog', '2016-01-03 16:25:00', 'Normal', 'Jackie', 'Neutered Male'),
('A413789', 'Dog', '2016-04-19 13:28:00', 'Normal', 'Benji', 'Spayed Female'),
('A414198', 'Dog', '2015-01-29 15:01:00', 'Normal', 'Shelly', 'Spayed Female'),
('A368930', 'Dog', '2014-06-08 13:20:00', 'Normal', NULL, 'Spayed Female');

INSERT INTO ANIMAL_OUTS2 (ANIMAL_ID, ANIMAL_TYPE, DATETIME, NAME, SEX_UPON_OUTCOME) VALUES
('A354597', 'Cat', '2014-05-02 12:16:00', 'Ariel', 'Spayed Female'),
('A373687', 'Dog', '2014-03-20 12:31:00', 'Rosie', 'Spayed Female'),
('A368930', 'Dog', '2014-06-13 15:52:00', NULL, 'Spayed Female');

SELECT * FROM ANIMAL_INS2;

SELECT * FROM ANIMAL_OUTS2;

-- 1
SELECT 
    NAME, DATETIME
FROM
    ANIMAL_INS2
WHERE
    ANIMAL_ID NOT IN (SELECT 
            ANIMAL_ID
        FROM
            ANIMAL_OUTS2)
ORDER BY 2
LIMIT 3;

-- 2
SELECT 
    AI.NAME, AI.DATETIME
FROM
    ANIMAL_INS2 AS AI
        LEFT JOIN
    ANIMAL_OUTS2 AS AO USING (ANIMAL_ID)
WHERE
    AO.ANIMAL_ID IS NULL
ORDER BY 2
LIMIT 3;